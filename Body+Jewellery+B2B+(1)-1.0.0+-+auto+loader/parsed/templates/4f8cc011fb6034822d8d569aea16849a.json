{
  "pages/checkout": "{{#partial \"head\"}}\n\n{{{ checkout.checkout_head }}}\n{{{ stylesheet '/assets/css/optimized-checkout.css' }}}\n{{ getFontsCollection }}\n\n<script type=\"text/javascript\">\n    window.language = {{{langJson 'optimized_checkout'}}};\n</script>\n\n{{{head.scripts}}}\n\n{{/partial}}\n\n{{#partial \"page\"}}\n\n<script src=\"https://checkout-sdk.bigcommerce.com/v1/loader.js\"></script>\n\n<script>\n    const setCustomerMessage = () => {\n        let customerMessage = ``;\n        let objBundles = {};\n        let arrModifiers = [];\n\n        const cart = window.state.data.getCart();\n\n        cart?.lineItems?.physicalItems.forEach(lineItem => {\n            let commentLine = ``;\n            let bundleKey = false;\n            let isBundleParent = false;\n            let arrLineItemModifers = [];\n\n            lineItem?.options.forEach(option => {\n                const { name, value } = option;\n                if (['Bundle Parent', 'Bundle Child'].includes(name)) {\n                    commentLine = `${lineItem.name}: ${lineItem.sku} x ${lineItem.quantity}`;\n                    // Does the bundle already exist in the object\n                    if (!objBundles.hasOwnProperty(value)) {\n                        objBundles[value] = [];\n                    }\n\n                    bundleKey = value;\n                    \n                    if (name === 'Bundle Parent') {\n                        isBundleParent = true;\n                    }\n                } else if(name.toLowerCase().includes('colour')) {\n                    commentLine = `${lineItem.name}: ${lineItem.sku} x ${lineItem.quantity}`;\n                }\n\n                if (name.toLowerCase().indexOf('colour') > -1) {\n                    arrLineItemModifers.push(`${name}: ${value}`);\n                }\n            });\n\n            arrLineItemModifers.forEach(modifier => {\n                commentLine += `\n* ${modifier}`;\n            });\n\n            if (bundleKey) {\n                if (isBundleParent) {\n                    objBundles[bundleKey].unshift(`**${commentLine}**`);\n                } else {\n                    objBundles[bundleKey].push(commentLine);\n                }\n            } else {\n                arrModifiers.push(commentLine)\n            }\n        });\n\n        for (const key in objBundles) {\n            if (objBundles.hasOwnProperty(key)) {\n                customerMessage += `\n\nBUNDLE:`;\n                \n                objBundles[key].forEach(line => {\n                    customerMessage += `\n${line}`;\n                });\n            }\n        }\n\n        arrModifiers.forEach(item => {\n            if(item !== '') {\n            customerMessage += `\n\nITEM: ${item}`;\n            }\n        });\n\n        if (customerMessage) {\n            window.service.updateCheckout({ customerMessage })\n\n            console.log(customerMessage, 'msg');\n        }\n    };\n    const initSdk = async () => {\n        window.module = await checkoutKitLoader.load('checkout-sdk');\n        window.service = module.createCheckoutService();\n        window.state = await service.loadCheckout('{{{ checkout.id }}}');\n        setCustomerMessage();\n    };\n    initSdk();\n</script>\n\n<header class=\"checkoutHeader optimizedCheckout-header\">\n    <div class=\"checkoutHeader-content\">\n        <h1 class=\"is-srOnly\">{{lang 'checkout.title'}}</h1>\n        <h2 class=\"checkoutHeader-heading\">\n            <a class=\"checkoutHeader-link\" href=\"{{urls.home}}\">\n                {{#if checkout.header_image}}\n                    <img alt=\"{{settings.store_logo.title}}\" class=\"checkoutHeader-logo\" id=\"logoImage\" src=\"{{ checkout.header_image }}\"/>\n                {{ else }}\n                    <span class=\"header-logo-text\">{{settings.store_logo.title}}</span>\n                {{/if}}\n            </a>\n        </h2>\n    </div>\n</header>\n\n{{{ checkout.checkout_content }}}\n\n{{{ footer.scripts }}}\n\n\n<script type=\"text/javascript\">\n    window.onload = (e) => {\n        setTimeout(() => {\n            const checkoutButton = document.querySelector('#checkout-customer-continue') ?? '';\n            \n            if(checkoutButton) {\n                checkoutButton.textContent = 'Continue As Guest';\n            }\n        }, 3000)\n    }\n</script>\n{{/partial}}\n\n{{> layout/empty}}\n",
  "layout/empty": "<!DOCTYPE html>\n<html>\n<head>\n    <title>{{ head.title }}</title>\n    {{{ head.meta_tags }}}\n    {{{ head.config }}}\n\n    <link href=\"{{ head.favicon }}\" rel=\"shortcut icon\">\n    {{#block \"head\"}}{{/block}}\n</head>\n<body>\n    {{#block \"page\"}}{{/block}}\n</body>\n</html>\n"
}
